{"version":"1.130.0","results":[{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"a94c21e57501458fd36f7a8ebae4e0bd2c376af3e83d4a88c819d78d95c7e5809bdd3ed20f9b50087126983f2596bf0c89691847f084ccab3aa339d8178dc65d_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":25,"offset":87}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"app"},"$METHOD":{"start":{"line":1,"col":5,"offset":4},"end":{"line":1,"col":8,"offset":7},"abstract_content":"get"},"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$VALUE":{"start":{"line":3,"col":26,"offset":88},"end":{"line":3,"col":29,"offset":91},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"95dbb947715b240a19b117c6170d85ee8518eebe448385a6221084735ae3506038956915a5464f1c585145301d5eed98ec2ee9cf8b459130b6058ff8d3cb6914_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":25,"offset":87}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"04d3402271e81119d88bfdb313091bab04b49f3949bad96122bdfe9df4111272590e0cd399f0a086b9324884b426c4a26fddbb3c24f3da173c44a5b4e35fd904_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262},"extra":{"metavars":{"$RES":{"start":{"line":12,"col":9,"offset":236},"end":{"line":12,"col":12,"offset":239},"abstract_content":"res"},"$REQ":{"start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":25,"offset":252},"abstract_content":"req"},"$QUERY":{"start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"a94c21e57501458fd36f7a8ebae4e0bd2c376af3e83d4a88c819d78d95c7e5809bdd3ed20f9b50087126983f2596bf0c89691847f084ccab3aa339d8178dc65d_1","lines":"        res.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":31,"offset":258}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":10,"col":1,"offset":165},"end":{"line":10,"col":4,"offset":168},"abstract_content":"app"},"$METHOD":{"start":{"line":10,"col":5,"offset":169},"end":{"line":10,"col":8,"offset":172},"abstract_content":"get"},"$RES":{"start":{"line":12,"col":9,"offset":236},"end":{"line":12,"col":12,"offset":239},"abstract_content":"res"},"$REQ":{"start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":25,"offset":252},"abstract_content":"req"},"$VALUE":{"start":{"line":12,"col":32,"offset":259},"end":{"line":12,"col":35,"offset":262},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"95dbb947715b240a19b117c6170d85ee8518eebe448385a6221084735ae3506038956915a5464f1c585145301d5eed98ec2ee9cf8b459130b6058ff8d3cb6914_1","lines":"        res.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":31,"offset":258}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262},"extra":{"metavars":{"$RES":{"start":{"line":12,"col":9,"offset":236},"end":{"line":12,"col":12,"offset":239},"abstract_content":"res"},"$REQ":{"start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":25,"offset":252},"abstract_content":"req"},"$QUERY":{"start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"04d3402271e81119d88bfdb313091bab04b49f3949bad96122bdfe9df4111272590e0cd399f0a086b9324884b426c4a26fddbb3c24f3da173c44a5b4e35fd904_1","lines":"        res.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":25,"offset":252}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test.js","start":{"line":12,"col":22,"offset":249},"end":{"line":12,"col":35,"offset":262}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.formatted-sql-query.formatted-sql-query","path":"test.py","start":{"line":18,"col":5,"offset":401},"end":{"line":18,"col":26,"offset":422},"extra":{"metavars":{"$X":{"start":{"line":17,"col":54,"offset":360},"end":{"line":17,"col":58,"offset":364},"abstract_content":"user"},"$DB":{"start":{"line":18,"col":5,"offset":401},"end":{"line":18,"col":11,"offset":407},"abstract_content":"cursor","propagated_value":{"svalue_start":{"line":14,"col":14,"offset":255},"svalue_end":{"line":14,"col":27,"offset":268},"svalue_abstract_content":"conn.cursor()"}},"$SQL":{"start":{"line":18,"col":20,"offset":416},"end":{"line":18,"col":25,"offset":421},"abstract_content":"query","propagated_value":{"svalue_start":{"line":17,"col":13,"offset":319},"svalue_end":{"line":17,"col":89,"offset":395},"svalue_abstract_content":"f\"SELECT * FROM users WHERE username = '{user}' AND password = '{password}'\""}}},"message":"Detected possible formatted SQL query. Use parameterized queries instead.","metadata":{"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"references":["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"],"category":"security","technology":["python"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/python.lang.security.audit.formatted-sql-query.formatted-sql-query","shortlink":"https://sg.run/EkWw","semgrep.dev":{"rule":{"origin":"community","r_id":9637,"rule_id":"3qUP9k","rv_id":946343,"url":"https://semgrep.dev/playground/r/e1T98KK/python.lang.security.audit.formatted-sql-query.formatted-sql-query","version_id":"e1T98KK"}}},"severity":"WARNING","fingerprint":"6a907bdc0f98cffe2805d729d1f03c7b6f4bd1b4a6cbe1d15117be83bdc0de33a85de88fc9aff37944e256e1c8e364f618c42785004049ca7516ca1370490062_0","lines":"    cursor.execute(query)","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.sqlalchemy.security.sqlalchemy-execute-raw-query.sqlalchemy-execute-raw-query","path":"test.py","start":{"line":18,"col":5,"offset":401},"end":{"line":18,"col":26,"offset":422},"extra":{"metavars":{"$CONNECTION":{"start":{"line":18,"col":5,"offset":401},"end":{"line":18,"col":11,"offset":407},"abstract_content":"cursor","propagated_value":{"svalue_start":{"line":14,"col":14,"offset":255},"svalue_end":{"line":14,"col":27,"offset":268},"svalue_abstract_content":"conn.cursor()"}},"$QUERY":{"start":{"line":18,"col":20,"offset":416},"end":{"line":18,"col":25,"offset":421},"abstract_content":"query","propagated_value":{"svalue_start":{"line":17,"col":13,"offset":319},"svalue_end":{"line":17,"col":89,"offset":395},"svalue_abstract_content":"f\"SELECT * FROM users WHERE username = '{user}' AND password = '{password}'\""}}},"message":"Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql","https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm","https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"],"category":"security","technology":["sqlalchemy"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/python.sqlalchemy.security.sqlalchemy-execute-raw-query.sqlalchemy-execute-raw-query","shortlink":"https://sg.run/2b1L","semgrep.dev":{"rule":{"origin":"community","r_id":10563,"rule_id":"oqUz5y","rv_id":946452,"url":"https://semgrep.dev/playground/r/8KTKj19/python.sqlalchemy.security.sqlalchemy-execute-raw-query.sqlalchemy-execute-raw-query","version_id":"8KTKj19"}}},"severity":"ERROR","fingerprint":"d0a6c22fa9eba901abd9fd8719ed0f7145d1c2ae3b3dede428d2d218d0dc73b0c51404de5ffa4c12e17582ce1e9bfed8db29c24e49963da65f79ab7d31b90b30_0","lines":"    cursor.execute(query)","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"121194c727e5bac616218a28eee4131a6d0be5415f6a23d73777474fa2b62c04163e1b31d6792b41a31ba261cfb504c0a11c8ef0db56934a403bdc2d29f50600_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":25,"offset":87}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"app"},"$METHOD":{"start":{"line":1,"col":5,"offset":4},"end":{"line":1,"col":8,"offset":7},"abstract_content":"get"},"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$VALUE":{"start":{"line":3,"col":26,"offset":88},"end":{"line":3,"col":29,"offset":91},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"99b3563df97cfb1eeef5db42bc33199904a44e75481cad4be5108741fc6da46ebe8eb90b1e04de70119bb19078cdf44ff6a5978d7545ffadf798b1c81c5d6502_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":25,"offset":87}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"58cf2b472de34fddaa3f6974c523ebceee66bffed7336cc4f43bc273fd5cd32149e2c1418c3443655555c51d84fa69636071dfc3b49dedb4942e51ab87659bfd_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"extra":{"metavars":{"$RES":{"start":{"line":11,"col":3,"offset":228},"end":{"line":11,"col":6,"offset":231},"abstract_content":"res"},"$REQ":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244},"abstract_content":"req"},"$QUERY":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"121194c727e5bac616218a28eee4131a6d0be5415f6a23d73777474fa2b62c04163e1b31d6792b41a31ba261cfb504c0a11c8ef0db56934a403bdc2d29f50600_1","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":25,"offset":250}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":9,"col":1,"offset":163},"end":{"line":9,"col":4,"offset":166},"abstract_content":"app"},"$METHOD":{"start":{"line":9,"col":5,"offset":167},"end":{"line":9,"col":8,"offset":170},"abstract_content":"get"},"$RES":{"start":{"line":11,"col":3,"offset":228},"end":{"line":11,"col":6,"offset":231},"abstract_content":"res"},"$REQ":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244},"abstract_content":"req"},"$VALUE":{"start":{"line":11,"col":26,"offset":251},"end":{"line":11,"col":29,"offset":254},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"99b3563df97cfb1eeef5db42bc33199904a44e75481cad4be5108741fc6da46ebe8eb90b1e04de70119bb19078cdf44ff6a5978d7545ffadf798b1c81c5d6502_1","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":25,"offset":250}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"extra":{"metavars":{"$RES":{"start":{"line":11,"col":3,"offset":228},"end":{"line":11,"col":6,"offset":231},"abstract_content":"res"},"$REQ":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244},"abstract_content":"req"},"$QUERY":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"58cf2b472de34fddaa3f6974c523ebceee66bffed7336cc4f43bc273fd5cd32149e2c1418c3443655555c51d84fa69636071dfc3b49dedb4942e51ab87659bfd_1","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417},"extra":{"metavars":{"$RES":{"start":{"line":19,"col":3,"offset":391},"end":{"line":19,"col":6,"offset":394},"abstract_content":"res"},"$REQ":{"start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":19,"offset":407},"abstract_content":"req"},"$QUERY":{"start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"121194c727e5bac616218a28eee4131a6d0be5415f6a23d73777474fa2b62c04163e1b31d6792b41a31ba261cfb504c0a11c8ef0db56934a403bdc2d29f50600_2","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":25,"offset":413}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":17,"col":1,"offset":326},"end":{"line":17,"col":4,"offset":329},"abstract_content":"app"},"$METHOD":{"start":{"line":17,"col":5,"offset":330},"end":{"line":17,"col":8,"offset":333},"abstract_content":"get"},"$RES":{"start":{"line":19,"col":3,"offset":391},"end":{"line":19,"col":6,"offset":394},"abstract_content":"res"},"$REQ":{"start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":19,"offset":407},"abstract_content":"req"},"$VALUE":{"start":{"line":19,"col":26,"offset":414},"end":{"line":19,"col":29,"offset":417},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"99b3563df97cfb1eeef5db42bc33199904a44e75481cad4be5108741fc6da46ebe8eb90b1e04de70119bb19078cdf44ff6a5978d7545ffadf798b1c81c5d6502_2","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":25,"offset":413}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417},"extra":{"metavars":{"$RES":{"start":{"line":19,"col":3,"offset":391},"end":{"line":19,"col":6,"offset":394},"abstract_content":"res"},"$REQ":{"start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":19,"offset":407},"abstract_content":"req"},"$QUERY":{"start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"58cf2b472de34fddaa3f6974c523ebceee66bffed7336cc4f43bc273fd5cd32149e2c1418c3443655555c51d84fa69636071dfc3b49dedb4942e51ab87659bfd_2","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":19,"offset":407}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test2.js","start":{"line":19,"col":16,"offset":404},"end":{"line":19,"col":29,"offset":417}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":9,"offset":71},"end":{"line":3,"col":12,"offset":74},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":25,"offset":87},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"2cae3445ca00d2452b3ddbfe24cce33ca1a0b342a2131a37498412a76a4bd39d2134ec9f65c33ba0d933519b7961a598ff7c3759eb63c647e0754cee2618189e_0","lines":"        res.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":31,"offset":93}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"app"},"$METHOD":{"start":{"line":1,"col":5,"offset":4},"end":{"line":1,"col":8,"offset":7},"abstract_content":"get"},"$RES":{"start":{"line":3,"col":9,"offset":71},"end":{"line":3,"col":12,"offset":74},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":25,"offset":87},"abstract_content":"req"},"$VALUE":{"start":{"line":3,"col":32,"offset":94},"end":{"line":3,"col":35,"offset":97},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"4d1b28abb99ec950c942e280e5633fd00bc1d71655841c03431654d4b120b430448e285ffc063ae739253092f497ad03541752957bb7ebea880da346e4a8875c_0","lines":"        res.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":31,"offset":93}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":9,"offset":71},"end":{"line":3,"col":12,"offset":74},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":25,"offset":87},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"58a4279032522953b37b6ddff2844fb75895ce452da5862ac0b6fb37992b9e5d8e49e0e42bcf6ee81b4f2ef9a1f8f6021304495c9cf2e90de59e9f3e94ba97e6_0","lines":"        res.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":25,"offset":87}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test3.js","start":{"line":3,"col":22,"offset":84},"end":{"line":3,"col":35,"offset":97}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"81cb2f529cb3162c6d62d3d1b6f40b59e58517ed190e98b74c46a64e1f76a2caf2d57717789bd4645c322ed0cc4b648d69fd2126c34cf6508267689a4576afca_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":25,"offset":87}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"app"},"$METHOD":{"start":{"line":1,"col":5,"offset":4},"end":{"line":1,"col":8,"offset":7},"abstract_content":"get"},"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$VALUE":{"start":{"line":3,"col":26,"offset":88},"end":{"line":3,"col":29,"offset":91},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"12911381a0bcba55f70c20e189760289bf8e8928713fbc048f131e3b55b64cc5c5588451ce383448b831e3c5231a51919ecf8724c5fb7cef17ccce051c06a790_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":25,"offset":87}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"extra":{"metavars":{"$RES":{"start":{"line":3,"col":3,"offset":65},"end":{"line":3,"col":6,"offset":68},"abstract_content":"res"},"$REQ":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81},"abstract_content":"req"},"$QUERY":{"start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"e8e76e41c25aade2486b2bfa7bed29342f526af5c3156f7c1a70a3427a1b7bc079cb649f03ff1912bdbc6bc5e94a0fb059277a23f803c071e914b6b3d4d0ec95_0","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":19,"offset":81}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test4.js","start":{"line":3,"col":16,"offset":78},"end":{"line":3,"col":29,"offset":91}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"extra":{"metavars":{"$RES":{"start":{"line":11,"col":3,"offset":228},"end":{"line":11,"col":6,"offset":231},"abstract_content":"res"},"$REQ":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244},"abstract_content":"req"},"$QUERY":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::sink::redirect::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","shortlink":"https://sg.run/BDbW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":43795,"rule_id":"2ZUXkp","rv_id":947614,"url":"https://semgrep.dev/playground/r/d6TPzbX/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep","version_id":"d6TPzbX"}}},"severity":"WARNING","fingerprint":"81cb2f529cb3162c6d62d3d1b6f40b59e58517ed190e98b74c46a64e1f76a2caf2d57717789bd4645c322ed0cc4b648d69fd2126c34cf6508267689a4576afca_1","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":25,"offset":250}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-open-redirect.express-open-redirect","path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":9,"col":1,"offset":163},"end":{"line":9,"col":4,"offset":166},"abstract_content":"app"},"$METHOD":{"start":{"line":9,"col":5,"offset":167},"end":{"line":9,"col":8,"offset":170},"abstract_content":"get"},"$RES":{"start":{"line":11,"col":3,"offset":228},"end":{"line":11,"col":6,"offset":231},"abstract_content":"res"},"$REQ":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244},"abstract_content":"req"},"$VALUE":{"start":{"line":11,"col":26,"offset":251},"end":{"line":11,"col":29,"offset":254},"abstract_content":"url"}},"message":"The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.","metadata":{"technology":["express"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"category":"security","owasp":["A01:2021 - Broken Access Control"],"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect","shortlink":"https://sg.run/EpoP","semgrep.dev":{"rule":{"origin":"community","r_id":22081,"rule_id":"X5ULkq","rv_id":945801,"url":"https://semgrep.dev/playground/r/LjTXyLx/javascript.express.security.audit.express-open-redirect.express-open-redirect","version_id":"LjTXyLx"}}},"severity":"WARNING","fingerprint":"12911381a0bcba55f70c20e189760289bf8e8928713fbc048f131e3b55b64cc5c5588451ce383448b831e3c5231a51919ecf8724c5fb7cef17ccce051c06a790_1","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":25,"offset":250}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.web.tainted-redirect-express.tainted-redirect-express","path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"extra":{"metavars":{"$RES":{"start":{"line":11,"col":3,"offset":228},"end":{"line":11,"col":6,"offset":231},"abstract_content":"res"},"$REQ":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244},"abstract_content":"req"},"$QUERY":{"start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254},"abstract_content":"req.query.url"}},"message":"The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"display-name":"Open Redirect with Express","functional-categories":["web::sink::redirect::express","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"supersedes":["javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect"],"source":"https://semgrep.dev/r/javascript.express.web.tainted-redirect-express.tainted-redirect-express","shortlink":"https://sg.run/7KEAw","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":156138,"rule_id":"AbU9dKZ","rv_id":1041991,"url":"https://semgrep.dev/playground/r/vdTNvOw/javascript.express.web.tainted-redirect-express.tainted-redirect-express","version_id":"vdTNvOw"}}},"severity":"WARNING","fingerprint":"e8e76e41c25aade2486b2bfa7bed29342f526af5c3156f7c1a70a3427a1b7bc079cb649f03ff1912bdbc6bc5e94a0fb059277a23f803c071e914b6b3d4d0ec95_1","lines":" \tres.redirect(req.query.url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":19,"offset":244}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"test4.js","start":{"line":11,"col":16,"offset":241},"end":{"line":11,"col":29,"offset":254}},"req.query.url"]]},"engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.formatted-sql-query.formatted-sql-query","path":"vul.py","start":{"line":15,"col":5,"offset":382},"end":{"line":15,"col":26,"offset":403},"extra":{"metavars":{"$X":{"start":{"line":14,"col":54,"offset":341},"end":{"line":14,"col":58,"offset":345},"abstract_content":"user"},"$DB":{"start":{"line":15,"col":5,"offset":382},"end":{"line":15,"col":11,"offset":388},"abstract_content":"cursor","propagated_value":{"svalue_start":{"line":11,"col":14,"offset":236},"svalue_end":{"line":11,"col":27,"offset":249},"svalue_abstract_content":"conn.cursor()"}},"$SQL":{"start":{"line":15,"col":20,"offset":397},"end":{"line":15,"col":25,"offset":402},"abstract_content":"query","propagated_value":{"svalue_start":{"line":14,"col":13,"offset":300},"svalue_end":{"line":14,"col":89,"offset":376},"svalue_abstract_content":"f\"SELECT * FROM users WHERE username = '{user}' AND password = '{password}'\""}}},"message":"Detected possible formatted SQL query. Use parameterized queries instead.","metadata":{"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"references":["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"],"category":"security","technology":["python"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/python.lang.security.audit.formatted-sql-query.formatted-sql-query","shortlink":"https://sg.run/EkWw","semgrep.dev":{"rule":{"origin":"community","r_id":9637,"rule_id":"3qUP9k","rv_id":946343,"url":"https://semgrep.dev/playground/r/e1T98KK/python.lang.security.audit.formatted-sql-query.formatted-sql-query","version_id":"e1T98KK"}}},"severity":"WARNING","fingerprint":"1161eca760bb53177dcc0f40549212e583f6f167ecd1ddbd0828bf202000536e9af99a443aac1d2ebc6ce0b3f7b39e6eb14696bb2e30330db3a89814f86f5255_0","lines":"    cursor.execute(query)","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.sqlalchemy.security.sqlalchemy-execute-raw-query.sqlalchemy-execute-raw-query","path":"vul.py","start":{"line":15,"col":5,"offset":382},"end":{"line":15,"col":26,"offset":403},"extra":{"metavars":{"$CONNECTION":{"start":{"line":15,"col":5,"offset":382},"end":{"line":15,"col":11,"offset":388},"abstract_content":"cursor","propagated_value":{"svalue_start":{"line":11,"col":14,"offset":236},"svalue_end":{"line":11,"col":27,"offset":249},"svalue_abstract_content":"conn.cursor()"}},"$QUERY":{"start":{"line":15,"col":20,"offset":397},"end":{"line":15,"col":25,"offset":402},"abstract_content":"query","propagated_value":{"svalue_start":{"line":14,"col":13,"offset":300},"svalue_end":{"line":14,"col":89,"offset":376},"svalue_abstract_content":"f\"SELECT * FROM users WHERE username = '{user}' AND password = '{password}'\""}}},"message":"Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql","https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm","https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"],"category":"security","technology":["sqlalchemy"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/python.sqlalchemy.security.sqlalchemy-execute-raw-query.sqlalchemy-execute-raw-query","shortlink":"https://sg.run/2b1L","semgrep.dev":{"rule":{"origin":"community","r_id":10563,"rule_id":"oqUz5y","rv_id":946452,"url":"https://semgrep.dev/playground/r/8KTKj19/python.sqlalchemy.security.sqlalchemy-execute-raw-query.sqlalchemy-execute-raw-query","version_id":"8KTKj19"}}},"severity":"ERROR","fingerprint":"501ab908be0dde4013dd0736733b4eb52ec6373a0d4acc7322ff2168582edc1fd6c3c8816e75f7ff4eb088b26d44b242a98069d4ed936826be4b8e8fdca67ea9_0","lines":"    cursor.execute(query)","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":"Syntax error","message":"Syntax error at line findings.json:1:\n missing element","path":"findings.json"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on test.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"test.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on test2.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"test2.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on test3.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"test3.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on test4.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"test4.js"}],"paths":{"scanned":[".github\\workflows\\semgrep.yml",".gitignore",".gitlab-ci.yml","comments.py","findings.json","gitlab_comments.py","README.md","requirements.txt","test.js","test.py","test12.py","test2.js","test3.js","test4.js","vul.py"]},"time":{"rules":[],"rules_parse_time":11.425057172775269,"profiling_times":{"config_time":7.347594976425171,"core_time":14.790666580200195,"ignores_time":0.002471446990966797,"total_time":22.141940355300903},"parsing_time":{"total_time":0.026467084884643555,"per_file_time":{"mean":0.0024060986258766866,"std_dev":1.772986660744359e-005},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":1.4536731243133545,"per_file_time":{"mean":0.03461126486460367,"std_dev":0.007735337047601131},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.8136072158813477,"per_file_and_rule_time":{"mean":0.001386042957208429,"std_dev":2.3477020570608367e-005},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.16603875160217285,"per_def_and_rule_time":{"mean":0.0001085930357110352,"std_dev":1.3201765068443808e-007},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"targets":[],"total_bytes":0,"max_memory_bytes":8576900992},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[]}
